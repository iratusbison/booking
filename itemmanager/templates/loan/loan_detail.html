{% extends "core/dashboard.html" %}
{% block dashboard_content %}
{% load custom_filter %}

<div style="text-align: center;">
    <table class="loan-details">
        <tr>
            <th>Loan Details</th>
            <th>Values</th>
        </tr>
        <tr>
            <td>Amount</td>
            <td>₹ {{ loan.amount }}</td>
        </tr>
        <tr>
            <td>Interest Rate</td>
            <td>{{ loan.interest_rate }}%</td>
        </tr>
        <tr>
            <td>Start Date</td>
            <td>{{ loan.start_date }}</td>
        </tr>
        <tr>
            <td>End Date</td>
            <td>{{ loan.end_date }}</td>
        </tr>
        <tr>
            <td>Interest</td>
            <td>₹ {{ loan.calculate_interest|floatformat:2 }}</td>
        </tr>
        <tr>
            <td>Interest added with loan amount</td>
            <td>₹ {{ total_amount|floatformat:2 }}</td>
        </tr>
    </table>

    <table class="payment-details">
        <h4>Payments</h4>
        <thead>
            <tr>
                <th>Payment Amount</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for payment in payments %}
                <tr>
                    <td>₹ {{ payment.amount }}</td>
                    <td>{{ payment.payment_date }}</td>
                    <td>
                        <form method="post" action="{% url 'delete_payment' section.id loan.id %}" onsubmit="return confirm('Are you sure you want to delete this payment?')">
                            {% csrf_token %}
                            <input type="hidden" name="payment_id" value="{{ payment.id }}">
                            <input type="submit" value="Delete">
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{% url 'make_payment' section.id loan.id %}" style="color: #333;">Make Payment</a>
</div>

<style>
    /* Style hyperlink text color and remove underlines */
    a {
        text-decoration: none;
        color: #333;
    }

    /* Style tables */
    table {
        width: 80%;
        border-collapse: collapse;
        margin: 20px auto;
    }

    table th, table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }

    table th {
        background-color: #f2f2f2;
    }
</style>
{% endblock %}
